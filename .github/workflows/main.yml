name: Auto Deploy App

on:
  push:
    branches: [ main ]

jobs:
  deploy-job:
    runs-on: ubuntu-latest
    
    steps:
      # –®–∞–≥ 1: –°–∫–∞—á–∏–≤–∞–µ–º –∫–æ–¥ (–∫–∞–∫ git clone)
      - name: Download Code
        uses: actions/checkout@v4
        
      # –®–∞–≥ 2: –ó–∞–ø—É—Å–∫–∞–µ–º –Ω–∞—à —Å–∫—Ä–∏–ø—Ç –¥–µ–ø–ª–æ—è
      - name: Run Deploy Script
        run: |
          echo "üöÄ –ó–∞–ø—É—Å–∫–∞—é —Å–∫—Ä–∏–ø—Ç –¥–µ–ø–ª–æ—è..."
          # –î–∞–µ–º –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞
          if [ -f "deploy.sh" ]; then
            chmod +x deploy.sh
            ./deploy.sh
          else
            echo "‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ: —Ñ–∞–π–ª deploy.sh –Ω–µ –Ω–∞–π–¥–µ–Ω!"
            echo "–°–æ–∑–¥–∞—é —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –≤–º–µ—Å—Ç–æ —Å–∫—Ä–∏–ø—Ç–∞..."
            touch test_file.txt
          fi
          echo "‚úÖ –°–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω!"
          
      # –®–∞–≥ 3: –°–æ–∑–¥–∞–µ–º –æ—Ç—á–µ—Ç
      - name: Create Report
        run: |
          echo "# –û—Ç—á–µ—Ç –æ –¥–µ–ø–ª–æ–µ" > report.md
          echo "- –î–∞—Ç–∞: $(date)" >> report.md
          echo "- –ö–æ–º–º–∏—Ç: ${{ github.sha }}" >> report.md
          echo "- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${{ github.actor }}" >> report.md
          echo "- –°—Ç–∞—Ç—É—Å: –£—Å–ø–µ—à–Ω–æ!" >> report.md
          
      # –®–∞–≥ 4: –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ç—á–µ—Ç (–ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –í–ï–†–°–ò–Ø)
      - name: Save Report
        uses: actions/upload-artifact@v4  # ‚Üê –í–û–¢ –¢–£–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï!
        with:
          name: deployment-report
          path: report.md

      - name: Upload File List
        uses: actions/upload-artifact@v4
        with:
          name: file-list
          path: file-list.txt
